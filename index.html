<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Values-Based Decision Making Training</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }
        
        .header {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #fff;
        }
        
        .header p {
            color: rgba(255,255,255,0.8);
            font-size: 16px;
        }
        
        .tabs {
            display: flex;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            opacity: 0.7;
        }
        
        .tab.active {
            opacity: 1;
            border-bottom-color: #4CAF50;
            background: rgba(255,255,255,0.1);
        }
        
        .tab.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }
        
        .content {
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .scenario-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .scenario-title {
            font-size: 24px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .scenario-description {
            margin-bottom: 20px;
            line-height: 1.6;
            color: rgba(255,255,255,0.9);
        }
        
        .btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .hidden { display: none; }
        
        .phase-container {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .timer {
            background: rgba(255,87,87,0.8);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }
        
        .choice-group {
            margin-bottom: 25px;
        }
        
        .choice-label {
            font-weight: bold;
            margin-bottom: 15px;
            color: #FFD700;
        }
        
        .choice-option {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .choice-option:hover {
            border-color: rgba(255,255,255,0.3);
        }
        
        .choice-option.selected {
            border-color: #4CAF50;
            background: rgba(76,175,80,0.2);
        }
        
        .choice-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .choice-desc {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
        }
        
        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .value-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .value-card:hover {
            border-color: rgba(255,255,255,0.3);
        }
        
        .value-card.selected {
            border-color: #4CAF50;
            background: rgba(76,175,80,0.2);
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 25px;
        }
        
        .coaching {
            background: rgba(76,175,80,0.1);
            border: 1px solid rgba(76,175,80,0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .coaching-title {
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 10px;
        }
        
        .status-bar {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .status-item {
            text-align: center;
        }
        
        .status-value {
            font-size: 24px;
            font-weight: bold;
        }
        
        .status-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .results {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
        }
        
        .score-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .score-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
        }
        
        .score-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .excellent { color: #4CAF50; }
        .good { color: #FFC107; }
        .needs-improvement { color: #FF5722; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Values-Based Decision Making Under Pressure</h1>
        <p>Navigate high-stakes leadership challenges while maintaining ethical alignment</p>
    </div>

    <div class="status-bar" id="statusBar">
        <div class="status-item">
            <div class="status-value" id="valuesScore">--</div>
            <div class="status-label">Values</div>
        </div>
        <div class="status-item">
            <div class="status-value" id="qualityScore">--</div>
            <div class="status-label">Quality</div>
        </div>
        <div class="status-item">
            <div class="status-value" id="impactScore">--</div>
            <div class="status-label">Impact</div>
        </div>
        <div class="status-item">
            <div class="status-value" id="systemsScore">--</div>
            <div class="status-label">Systems</div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="showTab('intro')">üìñ Introduction</div>
        <div class="tab disabled" onclick="showTab('scenario1')" id="tab1">üö® Crisis Response</div>
        <div class="tab disabled" onclick="showTab('scenario2')" id="tab2">üì¢ Media Crisis</div>
        <div class="tab disabled" onclick="showTab('scenario3')" id="tab3">‚öñÔ∏è Ethical Conflict</div>
    </div>

    <div class="content">
        <!-- Introduction Tab -->
        <div id="intro" class="tab-content">
            <div class="scenario-card">
                <h2>Understanding Values-Based Leadership Under Pressure</h2>
                <p style="margin: 20px 0;">This tool simulates realistic high-pressure leadership scenarios where you must make critical decisions while maintaining your core values. Each scenario includes timed decision phases with live coaching prompts.</p>
                
                <div style="background: rgba(255,87,87,0.1); border: 1px solid rgba(255,87,87,0.3); border-radius: 10px; padding: 20px; margin: 20px 0;">
                    <strong>‚ö†Ô∏è Why This Training Matters:</strong><br>
                    Research shows 73% of leaders make decisions under pressure that they later regret because they compromised their values or failed to consider long-term impacts.
                </div>

                <div style="background: rgba(76,175,80,0.1); border: 1px solid rgba(76,175,80,0.3); border-radius: 10px; padding: 20px; margin: 20px 0;">
                    <strong>‚úÖ Ready to Begin?</strong><br>
                    Each scenario takes 4-6 minutes with multiple timed phases and real coaching support.
                    <br><br>
                    <button class="btn" onclick="enableScenarios()">üöÄ I'm Ready - Enable Scenarios</button>
                </div>

                <div id="completion" class="hidden" style="background: rgba(76,175,80,0.2); border: 1px solid rgba(76,175,80,0.5); border-radius: 10px; padding: 20px; margin: 20px 0;">
                    <strong>üéØ Scenarios Now Available!</strong><br>
                    Click on the scenario tabs above to begin your training.
                </div>
            </div>
        </div>

        <!-- Scenario 1: Crisis Response -->
        <div id="scenario1" class="tab-content hidden">
            <div id="s1-intro" class="scenario-card">
                <div class="scenario-title">üö® Crisis Resource Allocation</div>
                <div class="scenario-description">
                    You are overseeing a multi-agency field response. A key shipment of medical supplies failed to arrive. Some staff blame protocol failures, others cite unpredictable circumstances. You need to respond quickly while maintaining team trust and operational effectiveness.
                </div>
                <div style="margin: 15px 0; font-size: 14px; opacity: 0.8;">
                    ‚è±Ô∏è 4 phases ‚Ä¢ ~4 minutes ‚Ä¢ High pressure
                </div>
                <button class="btn" onclick="startScenario(1)">Begin Decision Sequence ‚Üí</button>
            </div>

            <div id="s1-phases" class="hidden">
                <div id="s1-coaching" class="coaching">
                    <div class="coaching-title">üí° Live Coaching</div>
                    <div id="s1-prompt">Coaching guidance will appear here...</div>
                </div>

                <div id="s1-phase" class="phase-container">
                    <div class="phase-header">
                        <h3 id="s1-phase-title">Phase 1: Ground & Center</h3>
                        <div class="timer" id="s1-timer">15s</div>
                    </div>

                    <div id="s1-content">
                        <!-- Phase content will be dynamically loaded -->
                    </div>

                    <div class="controls">
                        <button class="btn" onclick="previousPhase(1)" id="s1-prev" disabled>‚Üê Previous</button>
                        <div>
                            <button class="btn" onclick="pauseTimer()" id="s1-pause">‚è∏Ô∏è Pause</button>
                            <button class="btn" onclick="nextPhase(1)" id="s1-next" disabled>Continue ‚Üí</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="s1-results" class="results hidden">
                <h2>Scenario 1 Complete!</h2>
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-number" id="s1-values">--</div>
                        <div>Values Alignment</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s1-quality">--</div>
                        <div>Decision Quality</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s1-impact">--</div>
                        <div>Stakeholder Impact</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s1-systems">--</div>
                        <div>Systems Awareness</div>
                    </div>
                </div>
                <div id="s1-feedback" style="background: rgba(76,175,80,0.1); border-radius: 10px; padding: 20px; margin: 20px 0;"></div>
                <button class="btn" onclick="showTab('scenario2')" style="margin-right: 10px;">Next Scenario ‚Üí</button>
                <button class="btn" onclick="restartScenario(1)">üîÑ Try Again</button>
            </div>
        </div>

        <!-- Scenario 2: Media Crisis -->
        <div id="scenario2" class="tab-content hidden">
            <div id="s2-intro" class="scenario-card">
                <div class="scenario-title">üì¢ Media Crisis Communication</div>
                <div class="scenario-description">
                    A serious incident has occurred. Reports are conflicting, media attention is intensifying, and stakeholders demand immediate statements. Your communication decisions will significantly impact public trust and response effectiveness.
                </div>
                <div style="margin: 15px 0; font-size: 14px; opacity: 0.8;">
                    ‚è±Ô∏è 4 phases ‚Ä¢ ~5 minutes ‚Ä¢ Extreme pressure
                </div>
                <button class="btn" onclick="startScenario(2)">Begin Decision Sequence ‚Üí</button>
            </div>

            <div id="s2-phases" class="hidden">
                <div id="s2-coaching" class="coaching">
                    <div class="coaching-title">üí° Live Coaching</div>
                    <div id="s2-prompt">Coaching guidance will appear here...</div>
                </div>

                <div id="s2-phase" class="phase-container">
                    <div class="phase-header">
                        <h3 id="s2-phase-title">Phase 1</h3>
                        <div class="timer" id="s2-timer">20s</div>
                    </div>
                    <div id="s2-content"></div>
                    <div class="controls">
                        <button class="btn" onclick="previousPhase(2)" id="s2-prev" disabled>‚Üê Previous</button>
                        <div>
                            <button class="btn" onclick="pauseTimer()" id="s2-pause">‚è∏Ô∏è Pause</button>
                            <button class="btn" onclick="nextPhase(2)" id="s2-next" disabled>Continue ‚Üí</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="s2-results" class="results hidden">
                <h2>Scenario 2 Complete!</h2>
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-number" id="s2-values">--</div>
                        <div>Values Alignment</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s2-quality">--</div>
                        <div>Decision Quality</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s2-impact">--</div>
                        <div>Stakeholder Impact</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s2-systems">--</div>
                        <div>Systems Awareness</div>
                    </div>
                </div>
                <div id="s2-feedback" style="background: rgba(76,175,80,0.1); border-radius: 10px; padding: 20px; margin: 20px 0;"></div>
                <button class="btn" onclick="showTab('scenario3')" style="margin-right: 10px;">Next Scenario ‚Üí</button>
                <button class="btn" onclick="restartScenario(2)">üîÑ Try Again</button>
            </div>
        </div>

        <!-- Scenario 3: Ethical Conflict -->
        <div id="scenario3" class="tab-content hidden">
            <div id="s3-intro" class="scenario-card">
                <div class="scenario-title">‚öñÔ∏è Ethical Policy Conflict</div>
                <div class="scenario-description">
                    Your organization must implement a new policy that conflicts with community values. Leadership expects compliance, but early feedback reveals ethical concerns and potential harm to vulnerable populations. You must balance organizational loyalty with community welfare.
                </div>
                <div style="margin: 15px 0; font-size: 14px; opacity: 0.8;">
                    ‚è±Ô∏è 4 phases ‚Ä¢ ~6 minutes ‚Ä¢ Maximum pressure
                </div>
                <button class="btn" onclick="startScenario(3)">Begin Decision Sequence ‚Üí</button>
            </div>

            <div id="s3-phases" class="hidden">
                <div id="s3-coaching" class="coaching">
                    <div class="coaching-title">üí° Live Coaching</div>
                    <div id="s3-prompt">Coaching guidance will appear here...</div>
                </div>

                <div id="s3-phase" class="phase-container">
                    <div class="phase-header">
                        <h3 id="s3-phase-title">Phase 1</h3>
                        <div class="timer" id="s3-timer">30s</div>
                    </div>
                    <div id="s3-content"></div>
                    <div class="controls">
                        <button class="btn" onclick="previousPhase(3)" id="s3-prev" disabled>‚Üê Previous</button>
                        <div>
                            <button class="btn" onclick="pauseTimer()" id="s3-pause">‚è∏Ô∏è Pause</button>
                            <button class="btn" onclick="nextPhase(3)" id="s3-next" disabled>Continue ‚Üí</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="s3-results" class="results hidden">
                <h2>All Scenarios Complete!</h2>
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-number" id="s3-values">--</div>
                        <div>Values Alignment</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s3-quality">--</div>
                        <div>Decision Quality</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s3-impact">--</div>
                        <div>Stakeholder Impact</div>
                    </div>
                    <div class="score-card">
                        <div class="score-number" id="s3-systems">--</div>
                        <div>Systems Awareness</div>
                    </div>
                </div>
                <div id="s3-feedback" style="background: rgba(76,175,80,0.1); border-radius: 10px; padding: 20px; margin: 20px 0;"></div>
                <button class="btn" onclick="restartScenario(3)">üîÑ Try Again</button>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'intro';
        let currentScenario = 0;
        let currentPhase = 0;
        let timer = null;
        let timeLeft = 0;
        let isPaused = false;
        let coachingInterval = null;
        let userChoices = {};
        let scores = { values: 0, quality: 0, impact: 0, systems: 0 };

        const scenarios = {
            1: {
                phases: [
                    { time: 15, title: "Ground & Center", prompts: ["What are the real consequences?", "Which values are most relevant?", "Take three deep breaths"] },
                    { time: 60, title: "Clarify Stakes", prompts: ["What values will guide decisions?", "What are the real stakes?", "How do you want to be remembered?"] },
                    { time: 90, title: "Generate Options", prompts: ["How to maintain values?", "What would a great leader do?", "Creative approaches that honor ethics?"] },
                    { time: 30, title: "Final Decision", prompts: ["Which balances values and effectiveness?", "How to communicate reasoning?", "What support is needed?"] }
                ]
            },
            2: {
                phases: [
                    { time: 20, title: "Information Assessment", prompts: ["What do I know vs assume?", "What values guide information sharing?"] },
                    { time: 45, title: "Stakeholder Prioritization", prompts: ["Who are affected stakeholders?", "What are their legitimate needs?"] },
                    { time: 75, title: "Message Development", prompts: ["Balance transparency with security?", "What tone honors urgency and respect?"] },
                    { time: 25, title: "Communication Execution", prompts: ["What channels reach key audiences?", "What follow-up commitment?"] }
                ]
            },
            3: {
                phases: [
                    { time: 30, title: "Values Conflict Analysis", prompts: ["What values create tension?", "Where might solutions exist?"] },
                    { time: 60, title: "Impact Assessment", prompts: ["Who benefits and bears costs?", "What are unintended consequences?"] },
                    { time: 90, title: "Solution Development", prompts: ["Honor both mandates and community?", "How to advocate within constraints?"] },
                    { time: 35, title: "Decision Implementation", prompts: ["How to explain authentically?", "What ongoing commitments?"] }
                ]
            }
        };

        const phaseContent = {
            1: [
                {
                    question: "What is the core challenge you're facing?",
                    choices: [
                        { id: "coord", title: "Coordination Breakdown", desc: "Communication failures between agencies led to the problem" },
                        { id: "account", title: "Accountability Crisis", desc: "Determining responsibility and preventing future failures" },
                        { id: "trust", title: "Team Trust & Morale", desc: "Rebuilding confidence while maintaining effectiveness" },
                        { id: "systems", title: "System Resilience", desc: "Addressing deeper vulnerabilities to prevent cascading failures" }
                    ],
                    values: true
                },
                {
                    question: "What values will guide your decision-making?",
                    choices: [
                        { id: "safety_service", title: "Safety & Service First", desc: "Prioritize community safety and public service above all" },
                        { id: "integrity_account", title: "Integrity & Accountability", desc: "Focus on honest communication and clear accountability" },
                        { id: "collab_excellence", title: "Collaboration & Excellence", desc: "Emphasize teamwork and continuous improvement" }
                    ]
                },
                {
                    question: "Choose your primary approach:",
                    choices: [
                        { id: "technical", title: "Technical Response", desc: "Investigate, reassign responsibilities, reinforce protocols" },
                        { id: "mixed", title: "Mixed Approach", desc: "Quick debrief, reinforce protocols, gather staff input" },
                        { id: "adaptive", title: "Adaptive Response", desc: "Use as case study to explore deeper system gaps" }
                    ]
                },
                {
                    question: "Your final decision and communication approach:",
                    choices: [
                        { id: "direct", title: "Direct & Decisive", desc: "Clear fixes with specific team responsibilities" },
                        { id: "collaborative", title: "Collaborative & Inclusive", desc: "Work together with team insights and commitment" },
                        { id: "learning", title: "Learning-Focused", desc: "Use situation to strengthen capabilities" },
                        { id: "values_based", title: "Values-Driven", desc: "Address thoroughly while supporting team growth" }
                    ]
                }
            ],
            2: [
                {
                    question: "What is your primary information challenge?",
                    choices: [
                        { id: "incomplete", title: "Incomplete Information", desc: "Key facts missing but pressure to communicate is intense" },
                        { id: "conflicting", title: "Conflicting Reports", desc: "Different sources provide contradictory information" },
                        { id: "speculation", title: "Controlling Speculation", desc: "Rumors spreading faster than verified facts" }
                    ],
                    values: true
                },
                {
                    question: "Which stakeholders should receive priority communication?",
                    choices: [
                        { id: "affected", title: "Directly Affected Parties", desc: "Those directly impacted deserve immediate, accurate information" },
                        { id: "response", title: "Response Teams", desc: "Field teams need clear information to coordinate effectively" },
                        { id: "public", title: "General Public", desc: "Community-wide transparency maintains trust" },
                        { id: "leadership", title: "Organizational Leadership", desc: "Senior leadership needs immediate briefings" }
                    ]
                },
                {
                    question: "What is your primary message approach?",
                    choices: [
                        { id: "facts_only", title: "Facts-Only Approach", desc: "Share only verified information with update commitments" },
                        { id: "context", title: "Context & Process", desc: "Explain what happened, response, and communication plan" },
                        { id: "transparency", title: "Full Transparency", desc: "Share everything known, investigating, and remaining questions" }
                    ]
                },
                {
                    question: "Your communication execution plan:",
                    choices: [
                        { id: "immediate", title: "Immediate Public Statement", desc: "Comprehensive statement now across all channels" },
                        { id: "staged", title: "Staged Communication", desc: "Brief key stakeholders first, then public release" },
                        { id: "responsive", title: "Responsive Approach", desc: "Regular schedule with proactive updates" }
                    ]
                }
            ],
            3: [
                {
                    question: "What is the core values conflict you're facing?",
                    choices: [
                        { id: "compliance", title: "Compliance vs. Community Impact", desc: "Organizational expectations vs. potential community harm" },
                        { id: "loyalty", title: "Loyalty vs. Integrity", desc: "Being a team player vs. speaking truth about concerns" },
                        { id: "efficiency", title: "Efficiency vs. Equity", desc: "Streamlined implementation vs. fair outcomes for all" }
                    ],
                    values: true
                },
                {
                    question: "Which impact concerns you most?",
                    choices: [
                        { id: "vulnerable", title: "Vulnerable Population Effects", desc: "Policy may harm those with least voice and resources" },
                        { id: "trust", title: "Community Trust Erosion", desc: "Implementation without addressing concerns damages relationships" },
                        { id: "team_morale", title: "Team Cohesion", desc: "Internal conflict affecting team effectiveness" },
                        { id: "precedent", title: "Organizational Precedent", desc: "How this is handled sets future expectations" }
                    ]
                },
                {
                    question: "What is your primary strategy?",
                    choices: [
                        { id: "advocate_up", title: "Upward Advocacy", desc: "Present community concerns with specific recommendations" },
                        { id: "pilot", title: "Pilot Implementation", desc: "Limited pilot to test approaches and gather data" },
                        { id: "enhanced", title: "Enhanced Implementation", desc: "Implement with additional safeguards and support" },
                        { id: "stakeholder", title: "Stakeholder Engagement", desc: "Structured dialogue between all parties" }
                    ]
                },
                {
                    question: "Your final approach and commitment:",
                    choices: [
                        { id: "transparent", title: "Transparent Process", desc: "Implementing with modifications based on concerns" },
                        { id: "accountable", title: "Accountable Implementation", desc: "Take responsibility with regular check-ins" },
                        { id: "collaborative", title: "Ongoing Collaboration", desc: "Decision reflects shared values, need partnership" },
                        { id: "adaptive", title: "Adaptive Approach", desc: "Start with this approach, adjust based on learning" }
                    ]
                }
            ]
        };

        function showTab(tabName) {
            if (tabName !== 'intro' && document.getElementById('completion').classList.contains('hidden')) {
                return;
            }

            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

            if (tabName === 'intro') {
                document.querySelector('.tab').classList.add('active');
            } else {
                document.getElementById(`tab${tabName.slice(-1)}`).classList.add('active');
            }

            document.getElementById(tabName).classList.remove('hidden');
            currentTab = tabName;
        }

        function enableScenarios() {
            document.querySelectorAll('.tab.disabled').forEach(tab => {
                tab.classList.remove('disabled');
            });
            document.getElementById('completion').classList.remove('hidden');
        }

        function startScenario(num) {
            currentScenario = num;
            currentPhase = 0;
            userChoices = {};
            scores = { values: 0, quality: 0, impact: 0, systems: 0 };
            
            document.getElementById(`s${num}-intro`).classList.add('hidden');
            document.getElementById(`s${num}-phases`).classList.remove('hidden');
            
            loadPhase(num, 0);
            updateStatusBar();
        }

        function loadPhase(scenarioNum, phaseNum) {
            const scenario = scenarios[scenarioNum];
            const phase = scenario.phases[phaseNum];
            const content = phaseContent[scenarioNum][phaseNum];

            document.getElementById(`s${scenarioNum}-phase-title`).textContent = `Phase ${phaseNum + 1}: ${phase.title}`;
            
            let html = `<div class="choice-group">
                <div class="choice-label">${content.question}</div>`;
            
            content.choices.forEach(choice => {
                html += `<div class="choice-option" onclick="selectChoice(${scenarioNum}, '${choice.id}')">
                    <div class="choice-title">${choice.title}</div>
                    <div class="choice-desc">${choice.desc}</div>
                </div>`;
            });
            
            html += `</div>`;
            
            if (content.values) {
                html += `<div class="choice-group">
                    <div class="choice-label">Select relevant values:</div>
                    <div class="values-grid">
                        <div class="value-card" onclick="selectValue('integrity')">
                            <strong>Integrity</strong><br>Honest communication
                        </div>
                        <div class="value-card" onclick="selectValue('safety')">
                            <strong>Safety</strong><br>Community well-being
                        </div>
                        <div class="value-card" onclick="selectValue('service')">
                            <strong>Service</strong><br>Public good focus
                        </div>
                        <div class="value-card" onclick="selectValue('accountability')">
                            <strong>Accountability</strong><br>Own decisions
                        </div>
                    </div>
                </div>`;
            }
            
            document.getElementById(`s${scenarioNum}-content`).innerHTML = html;
            
            startTimer(scenarioNum, phase.time);
            startCoaching(scenarioNum, phase.prompts);
            
            document.getElementById(`s${scenarioNum}-prev`).disabled = phaseNum === 0;
            document.getElementById(`s${scenarioNum}-next`).disabled = true;
        }

        function selectChoice(scenarioNum, choiceId) {
            document.querySelectorAll(`#s${scenarioNum}-content .choice-option`).forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.closest('.choice-option').classList.add('selected');
            
            if (!userChoices[currentPhase]) userChoices[currentPhase] = {};
            userChoices[currentPhase].choice = choiceId;
            
            checkCompletion(scenarioNum);
        }

        function selectValue(valueId) {
            event.target.classList.toggle('selected');
            
            if (!userChoices[currentPhase]) userChoices[currentPhase] = {};
            if (!userChoices[currentPhase].values) userChoices[currentPhase].values = [];
            
            const values = userChoices[currentPhase].values;
            if (values.includes(valueId)) {
                userChoices[currentPhase].values = values.filter(v => v !== valueId);
            } else {
                userChoices[currentPhase].values.push(valueId);
            }
            
            checkCompletion(currentScenario);
        }

        function checkCompletion(scenarioNum) {
            const hasChoice = userChoices[currentPhase] && userChoices[currentPhase].choice;
            const hasValues = currentPhase === 0 ? 
                (userChoices[currentPhase] && userChoices[currentPhase].values && userChoices[currentPhase].values.length > 0) : 
                true;
            
            document.getElementById(`s${scenarioNum}-next`).disabled = !(hasChoice && hasValues);
        }

        function startTimer(scenarioNum, seconds) {
            timeLeft = seconds;
            const timerEl = document.getElementById(`s${scenarioNum}-timer`);
            
            clearInterval(timer);
            timer = setInterval(() => {
                if (!isPaused) {
                    timeLeft--;
                    timerEl.textContent = timeLeft + 's';
                    
                    if (timeLeft <= 5) {
                        timerEl.style.background = 'rgba(255,87,87,0.9)';
                    } else if (timeLeft <= 10) {
                        timerEl.style.background = 'rgba(255,193,7,0.8)';
                    }
                    
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        document.getElementById(`s${scenarioNum}-next`).disabled = false;
                    }
                }
            }, 1000);
        }

        function startCoaching(scenarioNum, prompts) {
            let promptIndex = 0;
            const promptEl = document.getElementById(`s${scenarioNum}-prompt`);
            
            clearInterval(coachingInterval);
            
            function updatePrompt() {
                promptEl.textContent = prompts[promptIndex];
                promptIndex = (promptIndex + 1) % prompts.length;
            }
            
            updatePrompt();
            coachingInterval = setInterval(updatePrompt, 3000);
        }

        function nextPhase(scenarioNum) {
            // Calculate and add scores
            const phaseScore = calculatePhaseScore();
            scores.values += phaseScore.values;
            scores.quality += phaseScore.quality;
            scores.impact += phaseScore.impact;
            scores.systems += phaseScore.systems;
            
            updateStatusBar();
            
            clearInterval(timer);
            clearInterval(coachingInterval);
            
            currentPhase++;
            if (currentPhase >= scenarios[scenarioNum].phases.length) {
                showResults(scenarioNum);
            } else {
                loadPhase(scenarioNum, currentPhase);
            }
        }

        function previousPhase(scenarioNum) {
            if (currentPhase > 0) {
                clearInterval(timer);
                clearInterval(coachingInterval);
                currentPhase--;
                loadPhase(scenarioNum, currentPhase);
            }
        }

        function pauseTimer() {
            isPaused = !isPaused;
            const pauseBtn = document.querySelector(`#s${currentScenario}-pause`);
            pauseBtn.textContent = isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
        }

        function calculatePhaseScore() {
            const baseScore = 20;
            const timeBonus = timeLeft > 0 ? 5 : 0;
            const valueBonus = (userChoices[currentPhase] && userChoices[currentPhase].values) ? 
                userChoices[currentPhase].values.length * 2 : 0;
            
            return {
                values: baseScore + valueBonus + Math.floor(Math.random() * 5),
                quality: baseScore + timeBonus + Math.floor(Math.random() * 5),
                impact: baseScore + Math.floor(Math.random() * 8),
                systems: baseScore + Math.floor(Math.random() * 6)
            };
        }

        function updateStatusBar() {
            document.getElementById('valuesScore').textContent = scores.values;
            document.getElementById('qualityScore').textContent = scores.quality;
            document.getElementById('impactScore').textContent = scores.impact;
            document.getElementById('systemsScore').textContent = scores.systems;
        }

        function showResults(scenarioNum) {
            document.getElementById(`s${scenarioNum}-phases`).classList.add('hidden');
            document.getElementById(`s${scenarioNum}-results`).classList.remove('hidden');
            
            document.getElementById(`s${scenarioNum}-values`).textContent = scores.values;
            document.getElementById(`s${scenarioNum}-quality`).textContent = scores.quality;
            document.getElementById(`s${scenarioNum}-impact`).textContent = scores.impact;
            document.getElementById(`s${scenarioNum}-systems`).textContent = scores.systems;
            
            // Add score styling
            const avgScore = (scores.values + scores.quality + scores.impact + scores.systems) / 4;
            let feedback = '';
            
            if (avgScore >= 80) {
                feedback = 'üéâ Excellent performance! You maintained strong values alignment while making quality decisions under pressure.';
                document.querySelectorAll(`#s${scenarioNum}-results .score-number`).forEach(el => el.className = 'score-number excellent');
            } else if (avgScore >= 60) {
                feedback = 'üëç Good work! You showed solid decision-making with room for growth in maintaining systems awareness under pressure.';
                document.querySelectorAll(`#s${scenarioNum}-results .score-number`).forEach(el => el.className = 'score-number good');
            } else {
                feedback = 'üí™ This scenario highlighted areas for development. Practice values clarification techniques for high-pressure situations.';
                document.querySelectorAll(`#s${scenarioNum}-results .score-number`).forEach(el => el.className = 'score-number needs-improvement');
            }
            
            document.getElementById(`s${scenarioNum}-feedback`).innerHTML = feedback;
        }

        function restartScenario(scenarioNum) {
            currentPhase = 0;
            userChoices = {};
            scores = { values: 0, quality: 0, impact: 0, systems: 0 };
            
            clearInterval(timer);
            clearInterval(coachingInterval);
            
            document.getElementById(`s${scenarioNum}-intro`).classList.remove('hidden');
            document.getElementById(`s${scenarioNum}-phases`).classList.add('hidden');
            document.getElementById(`s${scenarioNum}-results`).classList.add('hidden');
            
            updateStatusBar();
        }

        // Initialize
        updateStatusBar();
    </script>
</body>
</html>
