<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Values-Based Decision Making Under Pressure ‚Äî Revamped</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ---------- Base / Existing Styles (trimmed where unchanged) ---------- */
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;
  background:radial-gradient(ellipse at top,#0f0515 0%,#1a0a1a 30%,#2d1b2e 70%,#0f0515 100%);
  color:#fff;line-height:1.6;min-height:100vh;overflow-x:hidden
}
body::before{content:'';position:fixed;inset:0;
  background:
    radial-gradient(circle at 15% 25%,rgba(139,69,19,.15) 0%,transparent 50%),
    radial-gradient(circle at 85% 75%,rgba(75,0,130,.12) 0%,transparent 50%);
  pointer-events:none;z-index:-1}

/* ---------- Header ---------- */
.header-section{background:rgba(139,69,19,.08);backdrop-filter:blur(25px);
  border-bottom:1px solid rgba(139,69,19,.15);padding:40px;text-align:center}
.main-title{font-size:clamp(28px,5vw,42px);font-weight:600;margin-bottom:16px;
  background:linear-gradient(135deg,#fff,#e8d5b7);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:-.5px}
.main-subtitle{font-size:18px;color:rgba(255,255,255,.75);max-width:700px;margin:0 auto;font-weight:300}

/* ---------- Tabs (unchanged) ---------- */
.tab-navigation{background:rgba(0,0,0,.3);backdrop-filter:blur(15px);border-bottom:1px solid rgba(255,255,255,.05);
  display:flex;justify-content:center;overflow-x:auto}
.tab-item{padding:20px 30px;cursor:pointer;font-weight:500;font-size:14px;border-bottom:3px solid transparent;
  transition:.3s;white-space:nowrap;position:relative;background:rgba(255,255,255,.02);color:rgba(255,255,255,.6)}
.tab-item:hover{background:rgba(255,255,255,.04);color:rgba(255,255,255,.8)}
.tab-item.active{color:#fff;border-bottom-color:#e8d5b7;background:rgba(255,255,255,.06)}
.tab-item.disabled{opacity:.3;cursor:not-allowed;pointer-events:none}
.tab-item.intro.active{border-bottom-color:#ffc107;background:rgba(255,193,7,.1)}
.tab-item.scenario1.active{border-bottom-color:#e74c3c;background:rgba(231,76,60,.1)}
.tab-item.scenario2.active{border-bottom-color:#3498db;background:rgba(52,152,219,.1)}
.tab-item.scenario3.active{border-bottom-color:#9b59b6;background:rgba(155,89,182,.1)}

/* ---------- NEW: Status bar upgrades ---------- */
.status-bar{
  background:rgba(0,0,0,.3);backdrop-filter:blur(15px);padding:12px 20px;
  display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,.05);gap:18px
}
.status-left{display:flex;align-items:center;gap:24px;flex-wrap:wrap}
.status-indicators{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
.status-item{display:flex;flex-direction:column;align-items:flex-start;font-size:11px;color:rgba(255,255,255,.6);
  text-transform:uppercase;letter-spacing:1px;position:relative}
.status-value-row{display:flex;align-items:center;gap:8px}
.status-value{font-size:20px;font-weight:700;color:#fff;margin-bottom:2px}
.badge{
  font-size:10px;line-height:1;padding:4px 8px;border-radius:999px;border:1px solid transparent;
  text-transform:uppercase;letter-spacing:.6px;white-space:nowrap;user-select:none
}
.badge.red{color:#ff6b6b;border-color:rgba(231,76,60,.4);background:rgba(231,76,60,.12)}
.badge.amber{color:#ffb74d;border-color:rgba(243,156,18,.4);background:rgba(243,156,18,.12)}
.badge.gold{color:#e8d5b7;border-color:rgba(232,213,183,.4);background:rgba(232,213,183,.12)}
.badge.green{color:#2ecc71;border-color:rgba(46,204,113,.4);background:rgba(46,204,113,.12)}

/* tooltips */
.help{cursor:pointer;opacity:.75;transition:.2s}
.help:focus,.help:hover{opacity:1}
.tooltip{
  position:absolute;top:100%;left:0;margin-top:8px;min-width:220px;max-width:280px;z-index:5;
  background:rgba(20,20,20,.95);border:1px solid rgba(255,255,255,.08);backdrop-filter:blur(10px);
  color:#eaeaea;font-size:12px;line-height:1.4;border-radius:10px;padding:10px;display:none
}
.tooltip p{margin:0}
.status-item:focus-within .tooltip,.status-item:hover .tooltip{display:block}

/* pressure meter + legend */
.pressure-wrap{display:flex;flex-direction:column;gap:6px;min-width:230px}
.pressure-label{font-size:11px;color:rgba(255,255,255,.6)}
.pressure-meter{width:180px;height:6px;background:rgba(255,255,255,.1);border-radius:20px;overflow:hidden;position:relative}
.pressure-fill{height:100%;background:linear-gradient(90deg,#27ae60,#f39c12,#e74c3c);width:0%;transition:width .5s ease;border-radius:20px}
.pressure-scale{display:flex;align-items:center;gap:6px}
.scale-track{flex:1;height:8px;background:linear-gradient(90deg,#2ecc71,#f1c40f,#e67e22,#e74c3c);
  border-radius:999px;position:relative}
.ticks{position:absolute;inset:0;display:flex;justify-content:space-between;align-items:center;padding:0 6px}
.tick{width:2px;height:8px;background:rgba(255,255,255,.7);opacity:.5}
.scale-labels{display:flex;justify-content:space-between;font-size:10px;color:rgba(255,255,255,.6);margin-top:2px}

/* NEW: score legend flyout */
.legend-trigger{display:flex;align-items:center;gap:8px}
.legend-btn{
  background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);color:#fff;border-radius:10px;
  padding:8px 10px;font-size:12px;cursor:pointer
}
.legend-btn:hover{background:rgba(255,255,255,.12)}
.score-legend{
  position:fixed;right:20px;bottom:20px;z-index:50;width:320px;max-width:90vw;
  background:rgba(15,15,15,.9);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.12);
  border-radius:16px;box-shadow:0 10px 40px rgba(0,0,0,.5);display:none
}
.score-legend.open{display:block;animation:appear .25s ease-out}
@keyframes appear{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.legend-header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08)}
.legend-title{font-size:14px;font-weight:600;color:#e8d5b7}
.legend-close{background:none;border:none;color:#fff;font-size:18px;cursor:pointer}
.legend-body{padding:14px 16px;display:grid;gap:10px}
.band{display:flex;gap:10px;align-items:flex-start;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px}
.band .chip{width:14px;height:14px;border-radius:4px;margin-top:2px}
.chip.red{background:#e74c3c}.chip.amber{background:#f39c12}.chip.gold{background:#e8d5b7}.chip.green{background:#2ecc71}
.band h4{font-size:12px;margin:0 0 2px 0}
.band p{font-size:12px;margin:0;color:rgba(255,255,255,.8)}

/* layout containers (unchanged except class hook) */
.app-container{min-height:100vh;display:flex;flex-direction:column}
.main-content{flex:1;display:grid;grid-template-columns:320px 1fr;min-height:calc(100vh - 200px)}
.sidebar{background:rgba(139,69,19,.06);backdrop-filter:blur(20px);border-right:1px solid rgba(139,69,19,.1);padding:25px;overflow-y:auto}
.main-panel{padding:30px;overflow-y:auto;position:relative}

/* ... keep the rest of your original styles for cards, phases, buttons, results, etc. ... */

/* Responsive tweaks */
@media (max-width:1024px){
  .main-content{grid-template-columns:1fr}
}
</style>
</head>
<body>
<div class="app-container">
  <header class="header-section">
    <h1 class="main-title">Values-Based Decision Making Under Pressure</h1>
    <p class="main-subtitle">Navigate high-stakes leadership challenges while maintaining ethical alignment and systems awareness</p>
  </header>

  <!-- Tabs -->
  <nav class="tab-navigation">
    <div class="tab-item intro active" onclick="showTab('intro')" id="introTab">üìñ Step 1: Read First</div>
    <div class="tab-item scenario1 disabled" onclick="showTab('scenario1')" id="scenario1Tab">üö® Crisis Resource Allocation</div>
    <div class="tab-item scenario2 disabled" onclick="showTab('scenario2')" id="scenario2Tab">üì¢ Media Crisis Communication</div>
    <div class="tab-item scenario3 disabled" onclick="showTab('scenario3')" id="scenario3Tab">‚öñÔ∏è Ethical Policy Conflict</div>
  </nav>

  <!-- ---------- NEW: Upgraded Status Bar with scale & tooltips ---------- -->
  <div class="status-bar" aria-label="Live status">
    <div class="status-left">
      <div class="status-indicators">
        <div class="status-item" tabindex="0">
          <div class="status-value-row">
            <div id="valuesScore" class="status-value">--</div>
            <span id="valuesBadge" class="badge gold" aria-live="polite">‚Äî</span>
            <button class="help" aria-label="What does Values Alignment mean?" title="What does this mean?">‚ùì</button>
          </div>
          <div>Values Alignment</div>
          <div class="tooltip" role="tooltip">
            <p><strong>Values Alignment</strong> reflects how consistently your choices uphold stated values.</p>
            <p><em>80‚Äì100:</em> Excellent ‚Ä¢ <em>65‚Äì79:</em> Solid ‚Ä¢ <em>50‚Äì64:</em> Developing ‚Ä¢ <em>0‚Äì49:</em> Needs Attention</p>
          </div>
        </div>

        <div class="status-item" tabindex="0">
          <div class="status-value-row">
            <div id="decisionQuality" class="status-value">--</div>
            <span id="qualityBadge" class="badge gold">‚Äî</span>
            <button class="help" aria-label="What does Decision Quality mean?" title="What does this mean?">‚ùì</button>
          </div>
          <div>Decision Quality</div>
          <div class="tooltip"><p>Quality and rigor of your choices under time pressure.</p><p>Same scale: Excellent (80‚Äì100) ‚Üí Needs Attention (0‚Äì49).</p></div>
        </div>

        <div class="status-item" tabindex="0">
          <div class="status-value-row">
            <div id="stakeholderImpact" class="status-value">--</div>
            <span id="impactBadge" class="badge gold">‚Äî</span>
            <button class="help" aria-label="What does Stakeholder Impact mean?" title="What does this mean?">‚ùì</button>
          </div>
          <div>Stakeholder Impact</div>
          <div class="tooltip"><p>How well your actions consider benefits, costs, and equity across stakeholders.</p></div>
        </div>

        <div class="status-item" tabindex="0">
          <div class="status-value-row">
            <div id="systemsAwareness" class="status-value">--</div>
            <span id="systemsBadge" class="badge gold">‚Äî</span>
            <button class="help" aria-label="What does Systems Awareness mean?" title="What does this mean?">‚ùì</button>
          </div>
          <div>Systems Awareness</div>
          <div class="tooltip"><p>Awareness of ripple effects, second-order consequences, and resilience.</p></div>
        </div>
      </div>

      <!-- Legend trigger -->
      <div class="legend-trigger">
        <button id="legendBtn" class="legend-btn" aria-expanded="false" aria-controls="scoreLegend">What do the numbers mean?</button>
      </div>
    </div>

    <!-- Pressure Meter with labeled scale -->
    <div class="pressure-wrap">
      <div class="pressure-label">PRESSURE LEVEL</div>
      <div style="display:flex;align-items:center;gap:10px">
        <div class="pressure-meter" aria-label="Live pressure bar" title="Live pressure">
          <div id="pressureFill" class="pressure-fill"></div>
        </div>
        <div style="font-size:12px;color:rgba(255,255,255,.7)" id="pressureText">‚Äî</div>
      </div>
      <div class="pressure-scale" aria-hidden="true">
        <div class="scale-track">
          <div class="ticks">
            <span class="tick"></span><span class="tick"></span><span class="tick"></span><span class="tick"></span><span class="tick"></span>
          </div>
        </div>
      </div>
      <div class="scale-labels"><span>Low</span><span>Medium</span><span>High</span><span>Very High</span><span>Extreme</span></div>
    </div>
  </div>

  <!-- ---------- Score Legend Flyout ---------- -->
  <aside id="scoreLegend" class="score-legend" role="dialog" aria-modal="true" aria-labelledby="legendTitle">
    <div class="legend-header">
      <div class="legend-title" id="legendTitle">Score Scale (applies to all 4 metrics)</div>
      <button class="legend-close" id="legendClose" aria-label="Close">√ó</button>
    </div>
    <div class="legend-body">
      <div class="band">
        <span class="chip red"></span>
        <div><h4>0‚Äì49 ¬∑ Needs Attention</h4>
          <p>Reactive choices or limited grounding in values/systems. Pause, center, and widen your lens.</p></div>
      </div>
      <div class="band">
        <span class="chip amber"></span>
        <div><h4>50‚Äì64 ¬∑ Developing</h4>
          <p>Some alignment/rigor present; tighten verification, surface trade‚Äëoffs, and check biases.</p></div>
      </div>
      <div class="band">
        <span class="chip gold"></span>
        <div><h4>65‚Äì79 ¬∑ Solid</h4>
          <p>Consistent reasoning and value signals. Strengthen stakeholder balance and system implications.</p></div>
      </div>
      <div class="band">
        <span class="chip green"></span>
        <div><h4>80‚Äì100 ¬∑ Excellent</h4>
          <p>Clear values, high-quality analysis, balanced impact, strong systems thinking under pressure.</p></div>
      </div>
    </div>
  </aside>

  <!-- ---------- Main Content (your existing tool) ---------- -->
  <div class="main-content">
    <aside class="sidebar">
      <!-- ‚Ä¶ keep your existing sidebar sections (Live Coaching, Decision Framework, Progress) ‚Ä¶ -->
      <div class="sidebar-section" id="activeCoaching" style="display:none;">
        <h3 class="sidebar-title">Live Coaching</h3>
        <div id="coachingContent" class="sidebar-content">
          <div class="coaching-prompt">
            <div class="prompt-title">Active Guidance</div>
            <div id="activePrompt">Coaching prompts will appear here during scenarios...</div>
          </div>
        </div>
      </div>

      <div class="sidebar-section">
        <h3 class="sidebar-title">Decision Framework</h3>
        <div class="sidebar-content">
          <p style="margin-bottom:10px;font-size:13px;">Each scenario follows a structured approach:</p>
          <ul style="list-style:disc;padding-left:16px;font-size:12px;">
            <li><strong>Ground & Center:</strong> Identify core challenges</li>
            <li><strong>Clarify Stakes:</strong> Define what matters most</li>
            <li><strong>Generate Options:</strong> Create values-aligned solutions</li>
            <li><strong>Decide & Communicate:</strong> Make and explain your choice</li>
          </ul>
        </div>
      </div>

      <div class="sidebar-section">
        <h3 class="sidebar-title">Current Progress</h3>
        <div class="sidebar-content">
          <div style="font-size:12px;color:rgba(255,255,255,.7);">
            <div id="progressIndicator">Ready to begin scenarios</div>
            <div style="margin-top:10px;">
              <div style="background:rgba(255,255,255,.1);height:6px;border-radius:3px;">
                <div id="progressBar" style="background:linear-gradient(90deg,#2ecc71,#27ae60);height:100%;width:0%;border-radius:3px;transition:width .5s;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <main class="main-panel">
      <!-- Intro + Scenarios (your original HTML). To keep this file readable here,
           the content is identical to your version. Paste your scenario markup below. -->
      <!-- =================== INTRO TAB =================== -->
      <!-- (Use your original intro block) -->
      <div id="intro" class="tab-content active">
        <!-- (intro content unchanged; paste from your file) -->
        <div class="intro-content">
          <div class="intro-hero">
            <div class="step-indicator">üìñ Step 1: Read This First</div>
            <h2 class="intro-title">Understanding Values-Based Leadership Under Pressure</h2>
            <p class="intro-description">This tool simulates realistic high-pressure leadership scenarios‚Ä¶</p>
            <div style="background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.2);border-radius:12px;padding:20px;margin:25px 0;">
              <h4 style="color:#ff6b6b;margin-bottom:12px;font-size:14px;">‚ö†Ô∏è Important: Why This Training Matters</h4>
              <p style="color:rgba(255,255,255,.85);font-size:13px;line-height:1.5;">Research shows that 73% of leaders‚Ä¶</p>
            </div>
          </div>

          <div class="key-concepts">
            <div class="concept-card"><span class="concept-icon">‚è±Ô∏è</span><div class="concept-title">Timed Decision Phases</div><div class="concept-desc">Progressive time constraints simulate real pressure with coaching support</div></div>
            <div class="concept-card"><span class="concept-icon">üí°</span><div class="concept-title">Live Values Coaching</div><div class="concept-desc">Real-time guidance helps maintain ethical alignment under stress</div></div>
            <div class="concept-card"><span class="concept-icon">üìä</span><div class="concept-title">Multi-Dimensional Assessment</div><div class="concept-desc">Track values, quality, stakeholder impact, and systems awareness</div></div>
            <div class="concept-card"><span class="concept-icon">üîÑ</span><div class="concept-title">Progressive Complexity</div><div class="concept-desc">Scenarios build in difficulty and stakeholder complexity</div></div>
          </div>

          <div style="background:rgba(46,204,113,.1);border:1px solid rgba(46,204,113,.2);border-radius:16px;padding:25px;margin:30px 0;text-align:center;">
            <h4 style="color:#2ecc71;margin-bottom:15px;font-size:16px;">‚úÖ Ready to Begin?</h4>
            <p style="color:rgba(255,255,255,.8);margin-bottom:20px;font-size:14px;">Once you've read this introduction, you can proceed‚Ä¶</p>
            <button class="btn btn-primary" onclick="enableScenarios()" style="font-size:14px;padding:12px 25px;">üöÄ I'm Ready - Enable Scenarios</button>
          </div>

          <div class="completion-indicator" id="completionIndicator">
            <h4 style="color:#2ecc71;margin-bottom:10px;">üéØ Scenarios Now Available!</h4>
            <p style="color:rgba(255,255,255,.8);font-size:13px;">Click on the scenario tabs above to begin‚Ä¶</p>
          </div>
        </div>
      </div>

      <!-- =================== SCENARIOS =================== -->
      <!-- Paste your existing Scenario 1, 2, 3 markup here (unchanged). -->
      <!-- For brevity in this message, they‚Äôre omitted; your original HTML works as-is. -->
      <div id="scenario1" class="tab-content scenario-content"></div>
      <div id="scenario2" class="tab-content scenario-content"></div>
      <div id="scenario3" class="tab-content scenario-content"></div>

      <!-- Timer bubble (unchanged) -->
      <div class="timer-display" id="timerDisplay" aria-hidden="true">
        <div class="timer-ring" id="timerRing"></div>
        <div class="timer-value" id="timerValue">15</div>
        <div class="timer-label">SECONDS</div>
      </div>
    </main>
  </div>
</div>

<script>
/* ---------- Your original JS (data, phases, scoring)‚Ä¶ trimmed for space ----------
   Keep your scenarios object, timers, selection handling, scoring, etc.
   We‚Äôll hook into two functions: updateStatusBar() and updatePressure().
*/

/* ----- Minimal scaffolding so this file runs standalone in this snippet ----- */
let currentTab='intro',currentScenario=0,currentPhase=0,currentTimer=0,isPaused=false;
let timerInterval=null,coachingInterval=null,userResponses={},scenarioScores={};
function showTab(t){if(t!=='intro'&&!document.getElementById('completionIndicator').classList.contains('show')) return;
  document.querySelectorAll('.tab-item').forEach(x=>x.classList.remove('active'));
  document.getElementById(t+'Tab').classList.add('active');
  document.querySelectorAll('.tab-content').forEach(x=>x.classList.remove('active'));
  document.getElementById(t).classList.add('active');
  currentTab=t;
  if(t==='intro'){document.getElementById('timerDisplay').classList.remove('active');
    document.getElementById('activeCoaching').style.display='none';clearInterval(coachingInterval);}
}
function enableScenarios(){
  document.querySelectorAll('.tab-item.disabled').forEach(t=>t.classList.remove('disabled'));
  document.getElementById('completionIndicator').classList.add('show');
}
/* ----- END scaffolding ----- */

/* ===================== NEW: Meaningful Scale Logic ===================== */
function bandForScore(n){
  if(typeof n!=='number'||isNaN(n)) return {key:'gold',label:'‚Äî'};
  if(n>=80) return {key:'green',label:'Excellent'};
  if(n>=65) return {key:'gold',label:'Solid'};
  if(n>=50) return {key:'amber',label:'Developing'};
  return {key:'red',label:'Needs Attention'};
}

function setBadge(el, band){
  el.className='badge '+band.key;
  el.textContent=band.label;
  el.setAttribute('aria-label','Rating: '+band.label);
}

/* Hook into your existing updateStatusBar to also refresh badges */
function updateStatusBar(scenarioNum){
  const s = scenarioScores[scenarioNum];
  if(!s) return;
  const clamp = v => Math.min(100, Math.max(0, Math.round(v)));

  const vs = clamp(s.values_alignment);
  const dq = clamp(s.decision_quality);
  const si = clamp(s.stakeholder_impact);
  const sa = clamp(s.systems_awareness);

  document.getElementById('valuesScore').textContent = vs;
  document.getElementById('decisionQuality').textContent = dq;
  document.getElementById('stakeholderImpact').textContent = si;
  document.getElementById('systemsAwareness').textContent = sa;

  setBadge(document.getElementById('valuesBadge'), bandForScore(vs));
  setBadge(document.getElementById('qualityBadge'), bandForScore(dq));
  setBadge(document.getElementById('impactBadge'), bandForScore(si));
  setBadge(document.getElementById('systemsBadge'), bandForScore(sa));
}

/* Pressure level text based on width% */
function pressureLabel(p){
  if(p>=90) return 'Extreme';
  if(p>=70) return 'Very High';
  if(p>=50) return 'High';
  if(p>=30) return 'Medium';
  return 'Low';
}

/* Hook into your existing updatePressure function */
function updatePressure(){
  // If you already compute pressure elsewhere, feel free to replace this with your logic.
  const phaseFactor = (currentPhase+1)*20;
  const timeBoost = currentTimer<10 ? 20 : 0;
  const pressureLevel = Math.min(100, phaseFactor + timeBoost + Math.random()*10);

  const fill = document.getElementById('pressureFill');
  const txt  = document.getElementById('pressureText');
  fill.style.width = pressureLevel+'%';
  txt.textContent = pressureLabel(pressureLevel);
}

/* ---------- Legend open/close + a11y ---------- */
const legendBtn = document.getElementById('legendBtn');
const legend = document.getElementById('scoreLegend');
const legendClose = document.getElementById('legendClose');

function openLegend(){
  legend.classList.add('open'); legendBtn.setAttribute('aria-expanded','true');
  legend.focus();
}
function closeLegend(){
  legend.classList.remove('open'); legendBtn.setAttribute('aria-expanded','false');
  legendBtn.focus();
}
legendBtn?.addEventListener('click', () => legend.classList.contains('open') ? closeLegend() : openLegend());
legendClose?.addEventListener('click', closeLegend);
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && legend.classList.contains('open')) closeLegend(); });

/* ---------- Demo data so badges show even before scenarios ---------- */
document.addEventListener('DOMContentLoaded', () => {
  scenarioScores[1] = {values_alignment: 0, decision_quality: 0, stakeholder_impact: 0, systems_awareness: 0};
  updateStatusBar(1);
  updatePressure();
});
</script>
</body>
</html>
